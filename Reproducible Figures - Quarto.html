<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reproducible Figures - Assessed</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="Reproducible Figures - Quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="Reproducible Figures - Quarto_files/libs/quarto-html/quarto.js"></script>
<script src="Reproducible Figures - Quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="Reproducible Figures - Quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Reproducible Figures - Quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="Reproducible Figures - Quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Reproducible Figures - Quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Reproducible Figures - Quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Reproducible Figures - Quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Reproducible Figures - Quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Reproducible Figures - Assessed</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="adelie-penguin-walking" class="level2">
<h2 class="anchored" data-anchor-id="adelie-penguin-walking"><img src="images/Adelie%20Penguin%20Image.jpeg" class="img-fluid" alt="Adelie Penguin Walking"></h2>
<section id="question-01-data-visualisation-for-science-communication" class="level3">
<h3 class="anchored" data-anchor-id="question-01-data-visualisation-for-science-communication"><strong>QUESTION 01: Data Visualisation for Science Communication</strong></h3>
<p>Initially, I will be using the <u>Palmer Penguin dataset</u> to build a misleading graph. This firstly requires appropriate loading and cleaning of the data. My code is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>() <span class="co">#stores appropriate versions of libraries used </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The library is already synchronized with the lockfile.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### download necessary libraries </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ragg)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#turning the palmer penguins raw data into a csv file, and storing it in a folder "data", available in my Project and GitHub Repository: </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(penguins_raw, <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"penguins_raw.csv"</span>)) </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in the csv file: </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>penguins_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"penguins_raw.csv"</span>))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#creating a piped function to clean the penguin data, available in a folder "functions" in my Project and GitHub repository:</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"functions"</span>, <span class="st">"cleaning.R"</span>))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#assign the cleaned data</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>penguins_clean <span class="ot">&lt;-</span> <span class="fu">cleaning_penguins</span>(penguins_raw)  </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#writing a csv with the new, cleaned data:</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(penguins_clean, <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"penguins_clean.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>My misleading graph is the following:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducible-Figures---Quarto_files/figure-html/misleadinggraph-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">Misleading Graph</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Having data visualised graphically is imperative for data communication, and 91% of respondents in a survey agree that figure use increases reproducibility <span class="citation" data-cites="evanthiakaimaklioti2021">(<a href="#ref-evanthiakaimaklioti2021" role="doc-biblioref">Evanthia Kaimaklioti 2021</a>)</span>. In order to make a plot which is correct, but badly communicates the underlying data, I made a series of design choices in the generation process to mislead the reader. I chose to visualise the relationship between culmen length (measured in mm), and body mass (measured in grams). However, the axes titles I used were highly generalised to “Length” and “Mass”, without their units, in order to minimise the possibility of appropriate interpretation. This is deemed a critical flaw for reproducibility <span class="citation" data-cites="tufte2001">(<a href="#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>.</p>
<p>I chose to build a scatter plot - which are generally used to represent a relationship between two continuous variables. However, I gave the title “Does Culmen Length Affect Body Mass in Different Penguin Species’ Islands”; intimating a causal study, when in fact the visualisation produced is purely correlational <span class="citation" data-cites="wickham2023a">(<a href="#ref-wickham2023a" role="doc-biblioref">Wickham 2023a</a>)</span>. I added a regression line to the plot, and there is no annotation on the graph to show whether the slope is significant. With regards to the axes, I reversed Length on the x-axis, in order to mislead a reader on initial assessment into perceiving the correlation as negative when it is actually positive. This is a form of “spatial orientation violation”, which is highly detrimental to reproducibility, as most viewers must make at least two attempts to divine the correct meaning from the graph <span class="citation" data-cites="nguyen2021">(<a href="#ref-nguyen2021" role="doc-biblioref">Nguyen 2021</a>)</span>. I also increased the “jitter” to 20. This added a significant amount of random noise to the plot. Visually spreading out the points extended them past the linear regression, making it even harder to interpret.</p>
<p>Moreover, I chose to subset the data with regards to Island, as different species of penguin are found on different islands. Specifically, Adelaides are found on all islands, Gentoos only on Biscoe and Chinstraps only on Dream. As such, information about species cannot be divined from visualisations of islands, as is implied by the title. Finally, islands were colour-coded using a very colour-blind unfriendly palette, including simultaneous use of reds and greens.</p>
</section>
<section id="question-02-data-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="question-02-data-pipeline"><strong>QUESTION 02: Data Pipeline</strong></h3>
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction">Introduction</h4>
<p>The Palmer Penguins dataset records observations of foraging Adélie (<em>Pygoscelis adeliae</em>), Chinstrap (<em>Pygoscelis antarcticus</em>) and Gentoo (<em>Pygoscelis papua</em>) penguin species, near the Palmer Station, in the Palmer Archipelago, Antarctica. Recorded observations for each individual note the specific species, as well as the specific island (of Briscoe, Dream or Torgersen) in the Anvers region; as well as the developmental stage. Each observation is given an ID. Data collected include: clutch completion (either yes or no), the date of egg laying (YYYY-MM-DD), culmen length and depth as well as flipper length (all measured in mm), body mass (measured in grams), and sex (M/F).</p>
<p>In my pipeline, having loaded and cleaned my data, I will pose my <u>questions</u> and <u>hypotheses</u>, explain the <u>statistical method</u> I have chosen to adopt for my present analysis, explore and discuss my <u>results</u> (using both an exploratory and a results figure, which I will save<u>)</u>, and ultimately <u>conclude</u> my analysis with reference to its wider relevance.</p>
<p><strong>My question:</strong> is there a correlation between body mass and flipper length in different penguin species’ (here: Adélie, Chinstrap and Gentoo)?</p>
<p>Correlations between morphological traits (such as body mass and flipper length) are sometimes controlled by morphometric scaling <span class="citation" data-cites="shingleton2010">(<a href="#ref-shingleton2010" role="doc-biblioref">Shingleton 2010</a>)</span>. Morphometrically-scaled correlations are underpinned by the study of allometry: differences in the morphological growth <span class="citation" data-cites="nijhout2012">(<a href="#ref-nijhout2012" role="doc-biblioref">Nijhout 2012</a>)</span>. Allometry is a topic of current interest fundamentally, but also partly because morphological structure and function can exert a profound effect on an organism’s ecology.</p>
<p>I find penguin allometry a specifically interesting case study to run, because of the proposed effect of penguin morphology on ecology, arising from morphometric scaling. For example, we already know that Gentoo penguins, with a larger body mass and flipper length, can dive deeper to forage <span class="citation" data-cites="mccomb-turbitt2023">(<a href="#ref-mccomb-turbitt2023" role="doc-biblioref">McComb-Turbitt 2023</a>)</span>. In order to explore whether this ecological phenomenon might be underpinned by morphometric scaling, investigating a potential correlation is an interesting place to start.</p>
</section>
<section id="hypothesis" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis">Hypothesis</h4>
<p><strong>My Null Hypothesis (H<sub>0</sub>):</strong> there is no correlation between body mass and flipper length in any of the investigated penguin species’.</p>
<p><strong>My Alternate Hypothesis (H<sub>A</sub>):</strong> there is a correlation between body mass and flipper length in one (or more) of the investigated penguin species’.</p>
<p>To contextualise these hypotheses, under H<sub>0</sub> (no correlation between body mass and flipper length) there would be no morphometric scaling between these morphological traits. However, under H<sub>A</sub>, there would be morphometric scaling - thus revealing an interesting allometric facet of penguin development, with potential implications for their ecology.</p>
</section>
<section id="stats-method" class="level4">
<h4 class="anchored" data-anchor-id="stats-method">Stats Method</h4>
<p>In order to test my H<sub>0</sub>, I conduct a Pearson’s correlation coefficient analysis on two numerical variables included within the Palmer Penguins dataset - body mass (measured in grams), and flipper length (measured in mm).</p>
<p>Pearson’s correlation coefficient is a parametric measure of the linear relationship between two numeric variables, which can range from -1 (a perfect negative correlation), to +1 (a perfect positive correlation). It is useful as an introductory point for testing Hypotheses such as mine because it is a relatively simple statistical measure that is commonly employed, and therefore well-understood <span class="citation" data-cites="hashash2022">(<a href="#ref-hashash2022" role="doc-biblioref">Hashash 2022a</a>)</span>.</p>
<p>Pearson’s correlation coefficient has precedent for use in investigating potential morphometric scaling. For example, it has previously been used in studying correlations between human brain segregation and integration units <span class="citation" data-cites="li2024">(<a href="#ref-li2024" role="doc-biblioref">Li 2024</a>)</span>.</p>
<p>The equation for Pearson’s correlation coefficient is given as:</p>
<p><span class="math display">\[r = \Sigma(x_i-\bar x)(y_i-\bar y)/ \sqrt\Sigma(x_i-\bar x)(y_i-\bar y)\]</span>$$$$</p>
<p>To compare correlations between each species, I bootstrap the correlation coefficient estimates, in order to maximise statistical accuracy <span class="citation" data-cites="efron1993">(<a href="#ref-efron1993" role="doc-biblioref">Efron 1993a</a>)</span>. In order to make this bootstrapping reproducible, I have set a seed in my code.</p>
<p>Pearson’s correlation coefficient assumes that data are approximately linear. This can be visually assessed using my results figure (Fig 2). Moreover, Pearson’s correlation coefficient assumes that data are distributed normally <span class="citation" data-cites="hashash2022a">(<a href="#ref-hashash2022a" role="doc-biblioref">Hashash 2022b</a>)</span>. I have tested this in the <u>Supplementary Materials</u> section, to validate it as an appropriate statistical method for this dataset.</p>
</section>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">Results</h4>
<p>To gain an initial appreciation of the data, but not yet to run any statistical tests, I first created an exploratory figure. Exploratory figures are important to gain an appreciation for your data, without yet subjecting them to any rigorous testing <span class="citation" data-cites="wickham2023">(<a href="#ref-wickham2023" role="doc-biblioref">Wickham 2023b</a>)</span>.</p>
<p>Here, I generated a density figure to show the distribution of the raw data for my two variables of interest: body mass (g), and flipper length (mm).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Firstly, I create a density plot of body masses by species </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>body_mass_density <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>penguins_clean, <span class="fu">aes</span>(<span class="at">x=</span>body_mass_g, <span class="at">group=</span>species, <span class="at">fill=</span>species)) <span class="sc">+</span> <span class="co">#assigning a ggplot to penguins data with my variable of interest: body mass on x axes; subset by species </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="co">#density plot, smoothed to 1.0 for readability, and made slightly more transparent (0.75) for aesthetics </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="co">#colour-friendly palette fills plots,    made slightly transparent for aesthetics  </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="co">#colour-friendly palette around outside, too </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fig 1a | Density of Body Masses by Species"</span>, <span class="co">#graph title with figure reference</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Body Mass (g)"</span>, <span class="co">#x-axis title with units </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span> <span class="co">#y-axis title (does not require units)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span> <span class="co">#chosen for publication-quality figures </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"right"</span>, <span class="co">#moving the legend to the right, for readability </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span><span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>), <span class="do">### adjusting axes titles, text and legends for aesthetic spacing (central location), larger font size and emboldened for readability, publication-quality font chosen</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.1</span>, <span class="st">"cm"</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">11.5</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, I create the same plot, but for flipper length. </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>flipper_length_density <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>penguins_clean, <span class="fu">aes</span>(<span class="at">x=</span>flipper_length_mm, <span class="at">group=</span>species, <span class="at">fill=</span>species)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fig 1b | Density of Flipper Lengths by Species"</span>, </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Flipper Length (mm)"</span>, </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"right"</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span><span class="dv">15</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.1</span>, <span class="st">"cm"</span>),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">11.5</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>))</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Now, I print them both as a mutli-panel figure</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(body_mass_density, flipper_length_density, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducible-Figures---Quarto_files/figure-html/exploratoryfigure-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">Fig 1: an exploratory figure. | Fig 1a shows the density plot for Body Mass. | Fig 1b shows the density plot for Flipper Length.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Density plots are useful because of their estimate of the probability density function. This produces a smooth curve, from which it is easy to perceive data distribution.</p>
<p>Fig 1a shows body mass (g) on the x-axis, and density (the smoothed distribution of the continuous data) on the y-axis. Here, we can perceive overlapping densities of body masses between the 3 species, illustrating that the penguins exhibit similar overall body masses. However, a rough hierarchy emerges with regards to increasing body mass: Gentoo (yellow) &gt; Chinstrap (teal) &gt; Adélie (purple).</p>
<p>Fig 1b recapitulates a similar pattern. Here, we have flipper length (mm) on the x-axis, and density on the y-axis. Despite density overlap, an approximate hierarchy of increasing flipper length of Gentoo &gt; Chinstrap &gt; Adélie also emerges.</p>
<p>Hence, according to our exploratory Figure, all 3 species of penguin are morphologically similar with regard to their body mass and flipper length. However, a slight hierarchical pattern emerges.</p>
<p>For reproducibility, it is important that the figures as I have generated them under this current investigation are saved and kept, for maximum transparency <span class="citation" data-cites="schwab2022">(<a href="#ref-schwab2022" role="doc-biblioref">Schwab 2022a</a>)</span>. They can be found in the “figures” folder of my Reproducible Figures Project, and in my GitHub repository, here: <a href="https://github.com/daisyjeans/Reproducible-Figures/tree/main" title="[click here]">Reproducible Figures GitHub Repository</a>. I give the code for my figure-saving function, which itself is also saved in the “functions” folder of my Reproducible Figures Project and GitHub Repository, below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## In order to save this figure, I create another function, available in the "functions" folder of my Project, and in my GitHub Repository: </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"functions"</span>, <span class="st">"saving_figures.R"</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Then call this function with regard to the exploratory figure:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save_figure_png</span>(body_mass_density,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">here</span>(<span class="st">"figures"</span>, <span class="st">"Figure1_body_mass_density_plot.png"</span>), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">50</span>, <span class="at">res =</span> <span class="dv">500</span>, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save_figure_png</span>(flipper_length_density,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">here</span>(<span class="st">"figures"</span>, <span class="st">"Figure1_flipper_length_density_plot.png"</span>), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">50</span>, <span class="at">res =</span> <span class="dv">500</span>, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<p>Having gained a species-specific appreciation for the body mass and flipper length data, we can now ask the question:</p>
<p><em>Are the morphological traits of body mass and flipper length correlated?</em></p>
<p>To test this, I conduct a Pearson’s correlation coefficient analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Firstly, I extract the correlation coefficient and associated p-values from the cleaned penguin data, subset by species</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>correlation_data <span class="ot">&lt;-</span> penguins_clean <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">correlation_coefficient =</span> <span class="fu">cor</span>(body_mass_g, flipper_length_mm, <span class="at">use =</span> <span class="st">"complete.obs"</span>), <span class="co">#removed any rows with NA, which would prevent the correlation calculation</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">cor.test</span>(body_mass_g, flipper_length_mm)<span class="sc">$</span>p.value) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.data.frame</span>() <span class="co">#organise as a table</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Then, I use the knitr package to create a more readable table. This requires 25 digits to display a comparative p-value for Gentoo; it being so small. I add a title, for further readability. </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(correlation_data, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">digits =</span> <span class="dv">25</span>, <span class="at">caption =</span> <span class="st">"Species Correlation Coefficients and Associated p-values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Species Correlation Coefficients and Associated p-values</caption>
<colgroup>
<col style="width: 53%">
<col style="width: 30%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: right;">correlation_coefficient</th>
<th style="text-align: right;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie Penguin (Pygoscelis adeliae)</td>
<td style="text-align: right;">0.4682017</td>
<td style="text-align: right;">1.343265e-09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chinstrap penguin (Pygoscelis antarctica)</td>
<td style="text-align: right;">0.6415594</td>
<td style="text-align: right;">3.748130e-09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gentoo penguin (Pygoscelis papua)</td>
<td style="text-align: right;">0.7026665</td>
<td style="text-align: right;">1.330279e-19</td>
</tr>
</tbody>
</table>
<p>Correlation Test</p>
</div>
</div>
<p>Here, our table output shows a positive correlation coefficient for each of the 3 species, between body mass and flipper length. Moreover, each of these positive correlations is highly significant under the Pearson’s correlation coefficient analysis. This is shown by each of their associated p values being &lt;0.05, the conventionally utilised alpha significance level <span class="citation" data-cites="schwab2022">(<a href="#ref-schwab2022" role="doc-biblioref">Schwab 2022a</a>)</span>.</p>
<p>Correlations are more easily appreciated under visualisation. To facilitate this therefore, I built a scatter plot results figure, displaying the correlation between body mass (g) and flipper length (mm), for each species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## To create my Results Figure, I will generate a scatterplot of flipper length against body mass by species, showing the linear correlation with a regression line and 95% CIs for each species, and print the significant p-values atop this. </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>results_figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(penguins_clean, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> species)) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fig 2 | Scatter Graph of Flipper Length Against Body Mass, Coloured by Species"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Body Mass (g)"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Flipper Length (mm)"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Species"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2500</span>, <span class="dv">6500</span>)) <span class="sc">+</span> <span class="co">#set the limits of the x axis, for readability</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">240</span>)) <span class="sc">+</span> <span class="co">#ditto for the y axis</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">17</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="co">#the following code pastes on our species-specific p-values, in an appropriate place on the graph, for interpret- and readability </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5500</span>, <span class="at">y =</span> <span class="dv">190</span>, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Adelie: p ="</span>, <span class="fu">format</span>(correlation_data<span class="sc">$</span>p_value[<span class="dv">1</span>], <span class="at">scientific =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">colour =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5500</span>, <span class="at">y =</span> <span class="dv">185</span>, </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Chinstrap: p ="</span>, <span class="fu">format</span>(correlation_data<span class="sc">$</span>p_value[<span class="dv">2</span>], <span class="at">scientific =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5500</span>, <span class="at">y =</span> <span class="dv">180</span>, </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Gentoo: p ="</span>, <span class="fu">format</span>(correlation_data<span class="sc">$</span>p_value[<span class="dv">3</span>], <span class="at">scientific =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">colour =</span> <span class="st">"black"</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#finally, paste the figure</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>results_figure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducible-Figures---Quarto_files/figure-html/results%20figure-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">Fig 2, results figure. A scatter graph of flipper length (mm) against body mass (g), with regression lines and 95% CIs for each colour co-ordinated species.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Figure 2 is a scatter plot which shows body mass (g) on the x-axis, and flipper length (mm) on the y-axis. Each species is colour co-ordinated such that purple shows Adélie penguins, blue shows Chinstrap penguins, and yellow shows Gentoo penguins. Scatter plots are useful because they can facilitate easy perception of correlations between two numerical variables.</p>
<p>Each of the species of penguin demonstrates a positive correlation between these two variables, which can be assessed visually, by use of the species-specific regression lines. 95% confidence intervals (CIs) surround these regression lines in shaded grey, in order to visually quantify the certainty of the correlation. Here, the certainty is high.</p>
<p>Notably, a Pearson’s correlation coefficient also assumes an approximately linear relationship between variables <span class="citation" data-cites="hashash2022b">(<a href="#ref-hashash2022b" role="doc-biblioref">Hashash 2022c</a>)</span>, which can be verified using the linear regressions applied to this scatter plot. The significant p-values for each species are annotated onto the plot, for ease of visual appreciation. The Gentoo p-value must be displayed in black as opposed to yellow, for readability.</p>
<p>Clearly, this results plot exemplifies the positive correlation between body mass and flipper length for all 3 of the penguin species. To link this back to my hypotheses, here we can see that H<sub>0</sub> (a hypothesis of no correlation between body mass and flipper length for any of the penguins) is statistically disproven, allowing us to reject it. We have evidence that indicates morphometric scaling of body mass and flipper length in these penguin species.</p>
<p>Once again, it is important for maximum reproducibility that there is a saved copy of my generated Figure 2 <span class="citation" data-cites="schwab2022a">(<a href="#ref-schwab2022a" role="doc-biblioref">Schwab 2022b</a>)</span>. I save it to the “figures” folder of my Project using the following code. It can also be found in my <a href="https://github.com/daisyjeans/Reproducible-Figures/tree/main" title="[click again]">Reproducible Figures GitHub Repository</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## I reuse the previously made function to save the results figure: </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save_figure_png</span>(results_figure,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">here</span>(<span class="st">"figures"</span>, <span class="st">"Figure2_scatter_plot.png"</span>), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">30</span>, <span class="at">res =</span> <span class="dv">100</span>, <span class="at">scaling =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<p>It is clear that there exist positive correlations between body mass (g) and flipper length (mm) for all 3 penguin species.</p>
<p><em>Do these correlations significantly vary between the species?</em></p>
<p>In order to address this question, it is best practice to bootstrap our Pearson’s correlation coefficient estimates, to maximise our chances of achieving statistical accuracy <span class="citation" data-cites="efron1993a">(<a href="#ref-efron1993a" role="doc-biblioref">Efron 1993b</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For my boostrapped correlation test, I first define a function, which is saved in the functions folder of my Project and GitHub Repository, for ease of access. </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"functions"</span>, <span class="st">"bootstrapping.R"</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, I run the bootstrapping for each species using this function. I set a seed to ensure reproducibility. </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> penguins_clean <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>({</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">2963</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> ., <span class="at">statistic =</span> correlation_function, <span class="at">R =</span> <span class="dv">1000</span>) <span class="co">#repeated 1000 times, according to convention from the literature</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="ot">&lt;-</span> <span class="fu">quantile</span>(res<span class="sc">$</span>t, <span class="fl">0.025</span>) <span class="co">#calculating the lower bound of the 95% CI</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="ot">&lt;-</span> <span class="fu">quantile</span>(res<span class="sc">$</span>t, <span class="fl">0.975</span>) <span class="co">#calculating the upper bound of the 95% CI</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">correlation =</span> <span class="fu">mean</span>(res<span class="sc">$</span>t), <span class="at">ci_lower =</span> ci_lower, <span class="at">ci_upper =</span> ci_upper)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  }) <span class="co">#outputting the result as a table</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Building a nicer looking table, for readibility. 4dp again chosen for scientific precision. Appropriate title given. </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(bootstrap_results, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">"Correlation Coefficients + 95% CIs for Bootstrapped Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Correlation Coefficients + 95% CIs for Bootstrapped Data</caption>
<colgroup>
<col style="width: 58%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: right;">correlation</th>
<th style="text-align: right;">ci_lower</th>
<th style="text-align: right;">ci_upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie Penguin (Pygoscelis adeliae)</td>
<td style="text-align: right;">0.4700</td>
<td style="text-align: right;">0.3476</td>
<td style="text-align: right;">0.5741</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chinstrap penguin (Pygoscelis antarctica)</td>
<td style="text-align: right;">0.6453</td>
<td style="text-align: right;">0.5138</td>
<td style="text-align: right;">0.7522</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gentoo penguin (Pygoscelis papua)</td>
<td style="text-align: right;">0.7058</td>
<td style="text-align: right;">0.6126</td>
<td style="text-align: right;">0.7858</td>
</tr>
</tbody>
</table>
<p>Bootstrapped Correlation Test</p>
</div>
</div>
<p>The results of this bootstrapping of our Pearson’s correlation coefficient estimates show that all 95% CIs overlap between species. As such, we can infer that there is no significant difference in the strength of the positive correlation between body mass (g), and flipper length (mm), across these 3 different species of penguin.</p>
</section>
<section id="discussion" class="level4">
<h4 class="anchored" data-anchor-id="discussion">Discussion</h4>
<p>Initially, I generated an exploratory figure of density plots for both body mass and flipper length, between all 3 species of penguin. It is clear that they display similar body masses and flipper lengths. However, an approximate hierarchy emerges that is recapitulated between both morphological traits, where Gentoos are the largest, Chinstraps are intermediate and Adélies are smallest. The overlapping densities would indicate that this is not significant, and as it is an exploratory figure, no formal statistical analysis was conducted.</p>
<p>My Pearson’s correlation coefficient analysis outputted a highly significant correlation between body mass and flipper length for each of the 3 species, which is easily visualised using Fig 2. This allows me to reject H<sub>0</sub>, and is indicative of morphometric scaling between the morphological traits of body mass and flipper length in each of the 3 species.</p>
<p>Finally, I tested whether there was a significant difference in the strength of any of the correlations between the 3 species. Due to overlapping 95% confidence intervals of the bootstrapped Pearson’s correlation coefficients, there is no evidence to suggest this.</p>
<p>Taking all of this evidence together, we can infer that morphometric scaling does occur between body mass and flipper length for each of these 3 penguin species, and to a similar degree. As such, this does not support the proposition that morphometric scaling affects the ecology of these species’. Perhaps the ecological differences we observe, such as the ability of Gentoo penguins to forage deeper, arise from alternative sources: such as physiological differences. The testing of this hypothesis would require its own data collection and analysis.</p>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">Conclusion</h4>
<p>The study of allometry, and the correlations that arise due to morphometric scaling, is highly important in biological science. Understanding the “patterns of design” that constrain morphology is fundamental to developmental scientists, and the potential ecological repercussions of evolutionary changes in morphometric scaling are exciting <span class="citation" data-cites="shingleton2010">(<a href="#ref-shingleton2010" role="doc-biblioref">Shingleton 2010</a>)</span>. This present study has confirmed evidence of morphometric scaling 3 species of penguin: Gentoo, Chinstrap and Adélie; but finds no evidence of a change in this scaling between species that could be proposed to have an ecological effect. Potential studies in other species, or investigating other scaled morphological traits, would further plumb this scientific line of inquiry. The application of universal principles of structure and function can link both development and ecological biology in an exciting way, and this is being appreciated in a recent burst of publications investigating such relationships <span class="citation" data-cites="shingleton2010">(<a href="#ref-shingleton2010" role="doc-biblioref">Shingleton 2010</a>)</span>.</p>
</section>
<section id="supplementary-material" class="level4">
<h4 class="anchored" data-anchor-id="supplementary-material">Supplementary Material</h4>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Pearson’s Correlation Coefficient requires data to be normal
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>This can be tested using visual assessment of QuantileQuantile (QQ) Plots.</p>
<p>QQ plots compare the quantiles of the data in our sample (on the y-axis) to the theoretical quantiles of a normal distribution (on the x-axis), in order to investigate the extent to which these align. Complete alignment would indicate totally normal data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## In order to appropriately apply a Pearson's correlation coefficient, the data must be normal. I check this using a QQ Plot. </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the initial QQ plot to test the normality of the body mass data, given an appropriate title, and summarised in red by convention </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins_clean<span class="sc">$</span>body_mass_g, <span class="at">main =</span> <span class="st">"QQ Plot for Body Mass (g)"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins_clean<span class="sc">$</span>body_mass_g, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducible-Figures---Quarto_files/figure-html/normality%20testing-1.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">QQ plots for testing normality</figcaption><p></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, I test the normality of the flipper data, using the same format. </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(penguins_clean<span class="sc">$</span>flipper_length_mm, <span class="at">main =</span> <span class="st">"QQ Plot for Flipper Length (mm)"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(penguins_clean<span class="sc">$</span>flipper_length_mm, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducible-Figures---Quarto_files/figure-html/normality%20testing-2.png" class="img-fluid figure-img" width="960"></p>
<p></p><figcaption class="figure-caption">QQ plots for testing normality</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Both of our QQ Plots align relatively well with normality. Both show slight deviation at the extremes, known as kurtosis. However, this kurtosis is not extreme enough to invalidate the use of the Pearson’s correlation coefficient for this dataset. It is therefore deemed appropriate.</p>
</section>
</section>
<section id="question-03-data-visualisation-for-science-communication" class="level3">
<h3 class="anchored" data-anchor-id="question-03-data-visualisation-for-science-communication"><strong>QUESTION 03: Data Visualisation for Science Communication</strong></h3>
<section id="part-a" class="level4">
<h4 class="anchored" data-anchor-id="part-a">Part a)</h4>
<p>I have uploaded my RProject to GitHub: <a href="https://github.com/daisyjeans/Reproducible-Figures/tree/main" title="Git">Repository Link</a><br>
N.B. two contributors are noted for this repository: daisyjeans and daisyjeans2. Both contributors are myself.</p>
</section>
<section id="part-b" class="level4">
<h4 class="anchored" data-anchor-id="part-b">Part b)</h4>
<p>Partner’s GitHub link: <a href="https://github.com/ZigiButtercup/PenguinsAssignment36" title="click x3">Partner’s GitHub Link</a></p>
</section>
<section id="part-c" class="level4">
<h4 class="anchored" data-anchor-id="part-c">Part c)</h4>
<section id="what-elements-of-your-partners-code-helped-you-to-understand-their-data-pipeline" class="level5">
<h5 class="anchored" data-anchor-id="what-elements-of-your-partners-code-helped-you-to-understand-their-data-pipeline"><em>What elements of your partner’s code helped you to understand their data pipeline?</em>&nbsp;</h5>
<p><strong>My partner’s code frequently used annotations excellently.</strong> &nbsp;</p>
<p>For example, annotations were sometimes used directly above code, in order to “introduce” it. When reading the code, this means that I did not have to puzzle over what it meant, as I was reading the code already having an idea of what it was going to do.&nbsp;&nbsp;</p>
<p>Annotations were also occasionally used within the code, to explain small inclusions (such as which =2). This extra detail made me, a person unfamiliar with that specific coding sequence, understand it better.&nbsp;&nbsp;</p>
<p>Occasionally, small paragraphs of annotation were also used, which were excellent at moments of transition in the data pipeline, keeping me fully up to date on the trajectory of the code.&nbsp;&nbsp;</p>
<p>Annotations was also implemented to explain both the statistical input, and the data output, which I thought was a nice touch. For example, explaining what a QQ plot is, just in case the reader was not aware. Moreover, explaining an outputted histogram skew, to keep me following the trajectory of the pipeline.&nbsp;&nbsp;</p>
<p>Annotations also explained the choices of the coder, which I thought was excellent added detail. For example, they refer to the coding decisions they have made to maximise reproducibility, which is highly informative, and reassuring.&nbsp;&nbsp;</p>
<p><strong>My partner’s code had excellent use of functions.</strong> &nbsp;</p>
<p>For example, their function to clean the data was appropriately named (“penguins_clean”), and stored in a “functions” folder, such that it could be easily accessed in their Project and GitHub repository. It was also referenced in their detailed read.me file in their GitHub Repository, so I knew where to find it.</p>
<p><strong>My partner’s code was highly organised.</strong> &nbsp;</p>
<p>The generating of folders such as the aforementioned “functions”, and also a “data” folder where the original data could be preserved as a read-only file. This is excellent from a reproducibility perspective. A folder was also created for “figures”, which is highly beneficial from a reproducibility perspective, too.&nbsp;&nbsp;</p>
<p><strong>My partner’s code was, for the most part, highly reproducible.</strong> &nbsp;</p>
<p>They used the here() path to avoid setting a working directory, which meant I was less likely to suffer errors in using their data.&nbsp;&nbsp;</p>
<p><strong>My partner’s code used objects well.</strong> &nbsp;</p>
<p>The naming of objects were frequently very apt. For example, the name of the object gentoo_dataset, when specifying to just one species, was very sensible, and clearly explained at this transition. Another example is gentoo_lm_unlogged; the use of “unlogged” was wise, as having both logged and unlogged data at this point in the pipeline necessitated extra specificity, to maximise clarity.&nbsp;&nbsp;</p>
</section>
<section id="did-it-run-did-you-need-to-fix-anything" class="level5">
<h5 class="anchored" data-anchor-id="did-it-run-did-you-need-to-fix-anything"><em>Did it run? Did you need to fix anything?</em>&nbsp;</h5>
<p>My partner’s code ran fine, and I did not need to fix anything.&nbsp;&nbsp;</p>
</section>
<section id="what-suggestions-would-you-make-for-improving-their-code-to-make-it-more-understandable-or-reproducible-and-why" class="level5">
<h5 class="anchored" data-anchor-id="what-suggestions-would-you-make-for-improving-their-code-to-make-it-more-understandable-or-reproducible-and-why"><em>What suggestions would you make for improving their code to make it more understandable or reproducible, and why?</em>&nbsp;&nbsp;</h5>
<p><strong>Improving annotations:</strong>&nbsp;</p>
<p>In my opinion, some extra annotations would have been helpful, to thoroughly guide me through the code. For example, the initial library loading section is not annotated.&nbsp;&nbsp;</p>
<p>Abbreviations were also occasionally used, which could potentially lead to confusion. An example is “homo” instead of “homoscedasticity”.&nbsp;&nbsp;</p>
<p><strong>Object naming:</strong> &nbsp;</p>
<p>There were two objects whose names I felt could have been more specific to their use. The first was gentoo_explorplot (explor is abbreviated, and therefore potentially confusing). The second was gentoo_resultsplot; although this is indeed generating a results plot, I felt it would have been better to clearly label it with the direct plot being produced: a scatter graph.&nbsp;&nbsp;</p>
<p><strong>Redundant code:</strong>&nbsp;</p>
<p>Occasionally code was repeated, such as colnames(penguins_raw).&nbsp;&nbsp;</p>
<p><strong>Improving reproducibility:</strong>&nbsp;</p>
<p>In order to improve the reproducibility of this code, I would avoid using the install.packages(““) function. It worked on my computer, but is liable to creating errors in R.&nbsp;&nbsp;</p>
</section>
<section id="if-you-needed-to-alter-your-partners-figure-using-their-code-do-you-think-it-would-be-easy-or-difficult-and-why" class="level5">
<h5 class="anchored" data-anchor-id="if-you-needed-to-alter-your-partners-figure-using-their-code-do-you-think-it-would-be-easy-or-difficult-and-why"><em>If you needed to alter your partner’s figure using their code, do you think it would be easy or difficult, and why?</em>&nbsp;</h5>
<p>Overall, I think it would be relatively easy to alter a figure using my partner’s code. The code was well-spaced, logically ordered and easy to follow; thus making minor edits manageable. The only thing that may make it difficult was that some line-by-line annotations, such as for building the bodymass_histogram, were absent. These would be helpful, if a coder was unfamiliar with any of the lines, and needed to make a specific edit.&nbsp;&nbsp;</p>
</section>
</section>
<section id="part-d" class="level4">
<h4 class="anchored" data-anchor-id="part-d">Part d)</h4>
<section id="what-improvements-did-they-suggest-and-do-you-agree" class="level5">
<h5 class="anchored" data-anchor-id="what-improvements-did-they-suggest-and-do-you-agree">What improvements did they suggest, and do you agree?</h5>
<p>My partner suggested that my density plot chunk could have been split up for better readability. Whilst I deliberately chose to keep both graphs that produce the exploratory figure&nbsp;together in the same chunk to avoid potential confusion, I can appreciate how this may have been an overwhelming amount of code all at once. &nbsp;</p>
<p>My partner suggested that the coding of my body mass density plot had a paragraph-like format that was difficult to read, due to the comments spilling over lines. I took this decision deliberately due to a perceived necessity to explain my code in great detail. For reproducibility, it is my opinion that all code should be addressed and explained at least once, such that it can be interpreted by any person who wishes to interrogate my open, shared data pipeline. Since I generate two density plots, I chose to explain the first in great detail, such that with a full explanation of the code, the code for the second plot would not require this. However, this level of detail comes at a tradeoff, where my partner suggests it would make it harder to locate parts of the code to&nbsp;edit, on first glance. This I concur, but believe it is a tradeoff worth making, in the interests of reproducibility. My partner also suggested that indentations and tabs should be used here. They are, but due to the volume of annotation, I can see why it might look like they aren’t. Again, I feel that in this instance, at the start of the pipeline when laying out my first sections of code, it is justified. They note that the section below reads more easily – this is a consequence of not requiring such detail, it having previously been covered above. &nbsp;</p>
<p>My partner suggested that my exploratory plot should have been placed in my Introduction or Hypotheses section; and that running my statistical test should have been done inside my Statistical Methods section, as opposed to my Results section. However, I structured my data pipeline according to the recommendations of Mensch to maximise reproducibility. They stress the importance of displaying exploratory figures, and running of statistical tests, in the Results section. In order to allow the reader to gain a visual understanding of what the code is exploring at the very beginning, I could have perhaps generated a table&nbsp;that showed the head data for my variables of interest.&nbsp;<span class="citation" data-cites="mensch2017">(<a href="#ref-mensch2017" role="doc-biblioref">Mensch 2017</a>)</span></p>
<p>My partner suggested that a script creating many graphs would benefit from functions generalising this code and stored elsewhere. Although I already have functions for cleaning the penguin data, saving my figures, and bootstrapping my Pearson’s correlation coefficients – I do not have any functions regarding graph generation. Moreover, since my folder for functions already exists in my Reproducible Figures Project, and GitHub Repository, I feel that this would be both a beneficial, and relatively simple addition to improve my code. &nbsp;</p>
</section>
<section id="what-did-you-learn-about-writing-code-for-other-people" class="level5">
<h5 class="anchored" data-anchor-id="what-did-you-learn-about-writing-code-for-other-people">What did you learn about writing code for other people?</h5>
<p>I have learnt the importance of <strong>structure</strong>. Using chunks helps to deliver code in a palatable way to an interested reader, such that they do not get overwhelmed. This is imperative from a reproducibility perspective – where any interested reader should be able to consume our open and shared data pipeline. At a micro- level, the use of tabs and indentations within code also facilitates this, as well as making any potential edits from future readers easier. &nbsp;</p>
<p>I have learnt the importance of <strong>annotation</strong>. Whilst writing code, it was easy to become overly-familiar with my own data pipeline. Annotations remind me that it is necessary for a reader who is completely unfamiliar with the topic to still be able to understand my data pipeline with clarity. As such, providing personable introductory annotations throughout, and line-by-line detail initially, helped me to achieve this. &nbsp;</p>
<p>I have&nbsp;learnt the importance of <strong>organisation</strong>. A data pipeline cannot be easily understood, and therefore is not reproducible, if it is unintelligibly organised. Utilising a read.me file in my GitHub repository to introduce my data pipeline; creating appropriately named folders for my data, functions and figures; and labelling chunks to track data pipeline progress helped this. &nbsp;</p>
<p>Finally, I have learnt the importance of innate <strong>reproducibility</strong>; using a “renv” instead of install.packages(““), as well as comitting and pushing my files to an open and accessible GitHub Repository, such that my data pipeline should be as accessible and transparent as possible.</p>

</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-efron1993" class="csl-entry" role="doc-biblioentry">
Efron, Bradley. 1993a. <em>An Introduction to the Bootstrap.</em> 1st ed. Vol. 1. 1st Series 1. Harvard: CRC Press. <a href="https://www.hms.harvard.edu/bss/neuro/bornlab/nb204/statistics/bootstrap.pdf">https://www.hms.harvard.edu/bss/neuro/bornlab/nb204/statistics/bootstrap.pdf</a>.
</div>
<div id="ref-efron1993a" class="csl-entry" role="doc-biblioentry">
———. 1993b. <em>An Introduction to the Bootstrap.</em> 1st ed. Vol. 1. 1st Series 1. Harvard: CRC Press. <a href="https://www.hms.harvard.edu/bss/neuro/bornlab/nb204/statistics/bootstrap.pdf">https://www.hms.harvard.edu/bss/neuro/bornlab/nb204/statistics/bootstrap.pdf</a>.
</div>
<div id="ref-evanthiakaimaklioti2021" class="csl-entry" role="doc-biblioentry">
Evanthia Kaimaklioti, Samota. 2021. <span>“Knowledge and Attitudes Among Life Scientists Toward Reproducibility Within Journal Articles: A Research Survey.”</span> <em>Frontiers in Research Metrics and Analytics</em>, 1st series, 6 (1): 1–18. <a href="https://doi.org/10.3389/frma.2021.678554">https://doi.org/10.3389/frma.2021.678554</a>.
</div>
<div id="ref-hashash2022" class="csl-entry" role="doc-biblioentry">
Hashash, El. 2022a. <span>“A Comparison of the Pearson, Spearman Rank and Kendall Tau Correlation Coefficients Using Quantitative Variables.”</span> <em>Asian Journal of Probability and Statistics.</em>, Correlations, 20. (1): 36–48. <a href="https://doi.org/10.9734/AJPAS/2022/v20i3425.">https://doi.org/10.9734/AJPAS/2022/v20i3425.</a>
</div>
<div id="ref-hashash2022a" class="csl-entry" role="doc-biblioentry">
———. 2022b. <span>“A Comparison of the Pearson, Spearman Rank and Kendall Tau Correlation Coefficients Using Quantitative Variables.”</span> <em>Asian Journal of Probability and Statistics.</em>, Correlations, 20. (1): 36–48. <a href="https://doi.org/10.9734/AJPAS/2022/v20i3425.">https://doi.org/10.9734/AJPAS/2022/v20i3425.</a>
</div>
<div id="ref-hashash2022b" class="csl-entry" role="doc-biblioentry">
———. 2022c. <span>“A Comparison of the Pearson, Spearman Rank and Kendall Tau Correlation Coefficients Using Quantitative Variables.”</span> <em>Asian Journal of Probability and Statistics.</em>, Correlations, 20. (1): 36–48. <a href="https://doi.org/10.9734/AJPAS/2022/v20i3425.">https://doi.org/10.9734/AJPAS/2022/v20i3425.</a>
</div>
<div id="ref-li2024" class="csl-entry" role="doc-biblioentry">
Li, J. 2024. <span>“Morphometric Brain Organization Across the Human Lifespan Reveals Increased Dispersion Linked to Cognitive Performance.”</span> <em>PLOS Biology</em>, Neurology, 22 (6): 1–24. <a href="https://doi.org/e3002647.">https://doi.org/e3002647.</a>
</div>
<div id="ref-mccomb-turbitt2023" class="csl-entry" role="doc-biblioentry">
McComb-Turbitt, SP. 2023. <span>“Diving Efficiency at Depth and Pre-Breeding Foraging Effort Increase with Haemoglobin Levels in Gentoo Penguins.”</span> <em>Marine Ecology Progress Series.</em>, Diving, 722. (1): 1–17. <a href="https://doi.org/10.3354/meps14441.">https://doi.org/10.3354/meps14441.</a>
</div>
<div id="ref-mensch2017" class="csl-entry" role="doc-biblioentry">
Mensch, B. 2017. <span>“Ten Simple Rules for Structuring Papers.”</span> <em>PLOS Computational Biology</em>, Structuring, 13 (9): 1–9. <a href="https://doi.org/doi.org/10.1371">https://doi.org/doi.org/10.1371</a>.
</div>
<div id="ref-nguyen2021" class="csl-entry" role="doc-biblioentry">
Nguyen, V. T. 2021. <span>“Examining Data Visualization Pitfalls in Scientific Publications.”</span> <em>Vis. Comput. Ind. Biomed. Art</em>, Examining, 4 (27): 1–15. <a href="https://doi.org/doi.org/10.1186/s42492-021-00092-y">https://doi.org/doi.org/10.1186/s42492-021-00092-y</a>.
</div>
<div id="ref-nijhout2012" class="csl-entry" role="doc-biblioentry">
Nijhout, Frederik. 2012. <span>“Developmental Causes of Allometry: New Models and Implications for Phenotypic Plasticity and Evolution.”</span> <em>Integrative and Comparative Biology</em>, Allometry, Volume 52, (Issue 1): Pages 4352. <a href="https://academic.oup.com/icb/article/52/1/43/741331">https://academic.oup.com/icb/article/52/1/43/741331</a>.
</div>
<div id="ref-schwab2022" class="csl-entry" role="doc-biblioentry">
Schwab, S. 2022a. <span>“Ten Simple Rules for Good Research Practice.”</span> <em>PLOS Computational Biology</em>, Research practice, 18 (6): e1010139. <a href="https://doi.org/doi.org/10.1371">https://doi.org/doi.org/10.1371</a>.
</div>
<div id="ref-schwab2022a" class="csl-entry" role="doc-biblioentry">
———. 2022b. <span>“Ten Simple Rules for Good Research Practice.”</span> <em>PLOS Computational Biology</em>, Research practice, 18 (6): e1010139. <a href="https://doi.org/doi.org/10.1371">https://doi.org/doi.org/10.1371</a>.
</div>
<div id="ref-shingleton2010" class="csl-entry" role="doc-biblioentry">
Shingleton, Alexander. 2010. <span>“Allometry: The Study of Biological Scaling.”</span> <em>Nature Education Knowledge</em>, Nature education, 3 (10): 2. <a href="https://www.nature.com/scitable/knowledge/library/allometry-the-study-of-biological-scaling-13228439/">https://www.nature.com/scitable/knowledge/library/allometry-the-study-of-biological-scaling-13228439/</a>.
</div>
<div id="ref-tufte2001" class="csl-entry" role="doc-biblioentry">
Tufte, Edward. 2001. <em>The Visual Display of Quantitative Information</em>. 2nd ed. Vol. 1. 1st Series 1. Yale: Graphics Press. <a href="https://www.econ.upf.edu/~michael/visualdata/tufte-aesthetics_and_technique.pdf">https://www.econ.upf.edu/~michael/visualdata/tufte-aesthetics_and_technique.pdf</a>.
</div>
<div id="ref-wickham2023" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2023b. <em>R for Data Science: Import, Tidy, Transform, Visualise and Model Data</em>. 2nd ed. Vol. 1. 1st Series 2. Houston, Texas: O’Reilly Media. <a href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a>.
</div>
<div id="ref-wickham2023a" class="csl-entry" role="doc-biblioentry">
———. 2023a. <em>R for Data Science: Import, Tidy, Transform, Visualise and Model Data</em>. 2nd ed. Vol. 1. 1st Series 2. Houston, Texas: O’Reilly Media. <a href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>